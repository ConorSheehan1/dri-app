<% get_delivery_file @document  %>

<div class="dri_object_first_block">

  <% unless @asset.nil? %>
    <%= render :partial => "show_surrogate" %>
  <% end %>

  <dl class="dl-horizontal  dl-invert dri_object_metadata_readview">
    <% document_show_fields.each do |solr_fname, field| -%>
      <% if should_render_show_field? document, field %>
        <dt class="blacklight-<%= solr_fname.parameterize %>"><%= render_document_show_field_label :field => solr_fname %></dt>
        <dd class="blacklight-<%= solr_fname.parameterize %>"><%= render_document_show_field_value :document => document, :field => solr_fname %></dd>
      <% end -%>
    <% end -%>
  </dl>

  <%= render :partial => "show_downloads" %>

</div>
<!-- close dri_object_first_block -->

<div class="dri_object_second_block">

  <div class="dri_back_search"><%= link_back_to_catalog %></div>

  <% collection = governing_collection_solr(@document) %>

  <% unless collection.nil? %>
    <div class="dri_vc_title">
      <%= image_tag("vc_folder.png", :width=>"22", :height=>"12", :alt=>"Vc_folder" ) %>
      <%= link_to( t('dri.views.objects.legends.view_collection'), catalog_path(collection['id']) ) %>
    </div>
  <% end %>
  <!-- close vc_title -->

  <% unless collection.nil? %>
    <% if collection['cover_image_tesim'] && collection['cover_image_tesim'][0] %>
      <div class="dri_vc_image">
        <%= image_tag(collection['cover_image_tesim'][0], :width=>"230", :height=>"129", :alt=> t('dri.views.alt_tags.cover_image') ) %><!-- needs callback -->
      </div>
    <% end %>
  <% end %>
  <!-- close vc_title -->

  <% unless collection.nil? %>
    <ul class="dri_view_collection">
      <% @type_counts.keys.each do |key| %>
        <% unless @type_counts[key].blank?  %>
          <% link = @type_counts[key][:draft].present? ? "#{@type_counts[key][:published]} (#{@type_counts[key][:draft]})" : "#{@type_counts[key][:published]}" %>
          <li><%= link_to(t("dri.data.types.#{key}"), render_arbitrary_facet_links({:collection => collection['id'], :object_type => key})) %>
            <span class="dri_stat_num"><%= link_to(link, render_arbitrary_facet_links({:collection => collection['id'], :object_type => key})) %>
            <span class="dri_stat_num"></span>
          </li>
        <% end %>
      <% end %>
    </ul>
  <% end %>

  <%= render :partial => "tools" %>

  <% if signed_in? && (can?(:edit, @document)) %>
    <div class="dri_objecttools_title">
      <%= t('dri.views.catalog.titles.editor_tools') %>
    </div>

    <div class="dri_grey_button" >
      <%= link_to t('dri.views.catalog.links.edit_this_record'), url_for(:controller => "objects", :action => "edit", :id => @document.id), :id => "edit_record" %>
    </div>

  <% end %>

</div>
<!-- close dri_object_second_block -->
